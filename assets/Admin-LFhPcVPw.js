import{c as W,r as o,j as e,O as Y,B as F}from"./index-BbDgdMef.js";import{S as q}from"./search-BNJf8YnG.js";import{D as J}from"./download-DfIbKF-Z.js";import{C as K}from"./chevron-up-xA4MZOIw.js";/**
 * @license lucide-react v0.462.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Q=W("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),X=["guess it","pop","admin@11"],Z={accommodation:"Accommodation",ambassador_applications:"Ambassador Applications",contact_messages:"Contact Messages",guest_speaker_applications:"Guest Speaker Applications",registrations:"Registrations",sponsorship_form_submissions:"Sponsorship Submissions"},ee=["created_at","user_id"],oe=()=>{const[k,O]=o.useState(""),[R,M]=o.useState(!1),[u,I]=o.useState(""),[b,f]=o.useState([]),[h,y]=o.useState([]),[L,A]=o.useState(!1),[N,E]=o.useState(""),[l,D]=o.useState({key:null,direction:null}),[w,$]=o.useState({}),[j,g]=o.useState(1),[S]=o.useState(50),[x,P]=o.useState({current:0,total:0}),T=()=>{X.includes(k.toLowerCase().trim())?M(!0):alert("Access Denied: You don't have permission to access this page.")},U=async t=>{A(!0);try{const{count:s,error:a}=await F.from(t).select("*",{count:"exact",head:!0});if(a)throw console.error("Supabase count error:",a),new Error(`${a.message}

Hint: ${a.hint||"Check RLS policies"}
Code: ${a.code||"N/A"}`);console.log(`ðŸ“Š Total records in ${t}: ${s}`),P({current:0,total:s});let r=[];const n=1e3;let c=0,i=!0;for(;i;){const{data:m,error:d}=await F.from(t).select("*").range(c*n,(c+1)*n-1);if(d)throw console.error("Supabase error:",d),new Error(`${d.message}

Hint: ${d.hint||"Check RLS policies"}
Code: ${d.code||"N/A"}`);r=[...r,...m],i=m.length===n,c++,P({current:r.length,total:s}),console.log(`Fetched ${r.length} / ${s} rows...`)}if(console.log(`âœ… Fetched all ${r.length} records from ${t}`),r.length>0){const m=Object.keys(r[0]).filter(d=>!ee.includes(d));y(m),f(r)}else y([]),f([]);g(1),E(""),$({}),D({key:null,direction:null})}catch(s){console.error("Error fetching table data:",s),alert(`Error loading data:

`+s.message+`

Check console for more details.`),f([]),y([])}finally{A(!1)}},V=t=>{const s=t.target.value;I(s),s?U(s):(f([]),y([]))},B=t=>{let s="asc";l.key===t&&l.direction==="asc"&&(s="desc"),D({key:t,direction:s})},H=(t,s)=>{$(a=>({...a,[t]:s})),g(1)},p=()=>{let t=[...b];return N&&(t=t.filter(s=>h.some(a=>s[a]?.toString().toLowerCase().includes(N.toLowerCase())))),Object.keys(w).forEach(s=>{const a=w[s];a&&(t=t.filter(r=>r[s]?.toString().toLowerCase().includes(a.toLowerCase())))}),l.key&&t.sort((s,a)=>{const r=s[l.key],n=a[l.key];if(r==null)return 1;if(n==null)return-1;if(typeof r=="number"&&typeof n=="number")return l.direction==="asc"?r-n:n-r;const c=r.toString().toLowerCase(),i=n.toString().toLowerCase();return l.direction==="asc"?c.localeCompare(i):i.localeCompare(c)}),t},z=()=>{const t=p(),s=(j-1)*S,a=s+S;return t.slice(s,a)},G=()=>{const t=p();if(t.length===0){alert("No data to export");return}const s=h.join(","),a=t.map(m=>h.map(d=>{const C=m[d];return C==null?"":`"${C.toString().replace(/"/g,'""')}"`}).join(",")),r=[s,...a].join(`
`),n=new Blob([r],{type:"text/csv"}),c=window.URL.createObjectURL(n),i=document.createElement("a");i.href=c,i.download=`${u}_export_${new Date().toISOString().split("T")[0]}.csv`,i.click(),window.URL.revokeObjectURL(c)},v=Math.ceil(p().length/S),_=z();return R?e.jsx("div",{className:"min-h-screen bg-gray-900 text-white p-6 pt-20 lg:pt-24",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("h1",{className:"text-4xl font-bold mb-8",children:"Admin Dashboard"}),e.jsxs("div",{className:"bg-gray-800 rounded-lg p-6 mb-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-4 items-end",children:[e.jsxs("div",{className:"flex-1 min-w-64",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Select Table"}),e.jsxs("select",{value:u,onChange:V,className:"w-full px-4 py-2 rounded bg-gray-700 border border-gray-600 focus:border-blue-500 focus:outline-none",children:[e.jsx("option",{value:"",children:"-- Select a table --"}),Object.entries(Z).map(([t,s])=>e.jsx("option",{value:t,children:s},t))]})]}),u&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex-1 min-w-64",children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Search All Columns"}),e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-2.5 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",value:N,onChange:t=>{E(t.target.value),g(1)},className:"w-full pl-10 pr-4 py-2 rounded bg-gray-700 border border-gray-600 focus:border-blue-500 focus:outline-none",placeholder:"Search..."})]})]}),e.jsxs("button",{onClick:G,className:"px-4 py-2 bg-green-600 hover:bg-green-700 rounded flex items-center gap-2 transition",children:[e.jsx(J,{className:"h-5 w-5"}),"Export CSV"]})]})]}),u&&!L&&e.jsxs("div",{className:"mt-4 text-sm text-gray-400",children:["Showing ",_.length," of"," ",p().length," records",p().length!==b.length&&e.jsxs("span",{className:"ml-2 text-blue-400",children:["(filtered from ",b.length," total)"]})]})]}),L?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-blue-500"}),e.jsx("p",{className:"mt-4 text-gray-400",children:"Loading data..."}),x.total>0&&e.jsxs("div",{className:"mt-2 text-sm text-blue-400",children:[x.current," / ",x.total," records loaded",e.jsx("div",{className:"w-64 bg-gray-700 rounded-full h-2 mx-auto mt-2",children:e.jsx("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:`${x.current/x.total*100}%`}})})]})]}):u&&b.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-gray-800 rounded-lg overflow-hidden",children:e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-700",children:e.jsx("tr",{children:h.map(t=>e.jsx("th",{className:"px-4 py-3 text-left",children:e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{onClick:()=>B(t),className:"flex items-center gap-1 hover:text-blue-400 transition",children:[e.jsx("span",{className:"font-semibold",children:t}),l.key===t&&(l.direction==="asc"?e.jsx(K,{className:"h-4 w-4"}):e.jsx(Y,{className:"h-4 w-4"}))]})}),e.jsxs("div",{className:"relative",children:[e.jsx(Q,{className:"absolute left-2 top-2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Filter...",value:w[t]||"",onChange:s=>H(t,s.target.value),className:"w-full pl-8 pr-2 py-1 text-sm rounded bg-gray-600 border border-gray-500 focus:border-blue-500 focus:outline-none",onClick:s=>s.stopPropagation()})]})]})},t))})}),e.jsx("tbody",{children:_.map((t,s)=>e.jsx("tr",{className:"border-t border-gray-700 hover:bg-gray-750",children:h.map(a=>e.jsx("td",{className:"px-4 py-3 text-sm",children:t[a]!==null&&t[a]!==void 0?typeof t[a]=="boolean"?t[a]?"âœ“":"âœ—":Array.isArray(t[a])?t[a].join(", "):t[a].toString():e.jsx("span",{className:"text-gray-500",children:"-"})},a))},s))})]})})}),v>1&&e.jsxs("div",{className:"mt-6 flex items-center justify-center gap-4",children:[e.jsx("button",{onClick:()=>g(t=>Math.max(1,t-1)),disabled:j===1,className:"px-4 py-2 bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-600 transition",children:"Previous"}),e.jsxs("span",{className:"text-gray-400",children:["Page ",j," of ",v]}),e.jsx("button",{onClick:()=>g(t=>Math.min(v,t+1)),disabled:j===v,className:"px-4 py-2 bg-gray-700 rounded disabled:opacity-50 disabled:cursor-not-allowed hover:bg-gray-600 transition",children:"Next"})]})]}):u?e.jsx("div",{className:"text-center py-12 text-gray-400",children:"No data available in this table"}):null]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-900 text-white",children:e.jsxs("div",{className:"bg-gray-800 p-8 rounded-lg shadow-xl w-96",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6 text-center",children:"Admin Access"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium mb-2",children:"Enter Acess Code"}),e.jsx("input",{type:"password",value:k,onChange:t=>O(t.target.value),onKeyPress:t=>t.key==="Enter"&&T(),className:"w-full px-4 py-2 rounded bg-gray-700 text-white border border-gray-600 focus:border-blue-500 focus:outline-none",placeholder:"Enter Code here"})]}),e.jsx("button",{onClick:T,className:"w-full px-6 py-3 bg-blue-600 text-white rounded hover:bg-blue-700 transition",children:"Access Dashboard"})]})]})})};export{oe as default};
